{"version":3,"file":"TermFunctionStrBefore.js","sourceRoot":"","sources":["TermFunctionStrBefore.ts"],"names":[],"mappings":"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","sourcesContent":["import { TermFunctionBase } from '@comunica/bus-function-factory';\nimport type {\n  StringLiteral,\n\n  LangStringLiteral,\n} from '@comunica/utils-expression-evaluator';\nimport {\n  declare,\n  IncompatibleLanguageOperation,\n  langString,\n  SparqlOperator,\n  string,\n  TypeURL,\n} from '@comunica/utils-expression-evaluator';\nimport type { DirLangStringLiteral } from '@comunica/utils-expression-evaluator/lib/expressions';\nimport { dirLangString } from '@comunica/utils-expression-evaluator/lib/functions/Helpers';\nimport { IncompatibleDirectionalLanguageOperation } from '@comunica/utils-expression-evaluator/lib/util/Errors';\n\n/**\n * https://www.w3.org/TR/sparql11-query/#func-strbefore\n */\nexport class TermFunctionStrBefore extends TermFunctionBase {\n  public constructor() {\n    super({\n      arity: 2,\n      operator: SparqlOperator.STRBEFORE,\n      overloads: declare(SparqlOperator.STRBEFORE)\n        .onBinaryTyped(\n          [ TypeURL.XSD_STRING, TypeURL.XSD_STRING ],\n          () => (arg1: string, arg2: string) => string(arg1.slice(0, Math.max(0, arg1.indexOf(arg2)))),\n        )\n        .onBinary(\n          [ TypeURL.RDF_LANG_STRING, TypeURL.XSD_STRING ],\n          () => (arg1: LangStringLiteral, arg2: StringLiteral) => {\n            const [ a1, a2 ] = [ arg1.typedValue, arg2.typedValue ];\n            const sub = arg1.typedValue.slice(0, Math.max(0, a1.indexOf(a2)));\n            return sub || !a2 ? langString(sub, arg1.language) : string(sub);\n          },\n        )\n        .onBinary(\n          [ TypeURL.RDF_LANG_STRING, TypeURL.RDF_LANG_STRING ],\n          () => (arg1: LangStringLiteral, arg2: LangStringLiteral) => {\n            if (arg1.language !== arg2.language) {\n              throw new IncompatibleLanguageOperation(arg1, arg2);\n            }\n            const [ a1, a2 ] = [ arg1.typedValue, arg2.typedValue ];\n            const sub = arg1.typedValue.slice(0, Math.max(0, a1.indexOf(a2)));\n            return sub || !a2 ? langString(sub, arg1.language) : string(sub);\n          },\n        )\n        .onBinary(\n          [ TypeURL.RDF_DIR_LANG_STRING, TypeURL.XSD_STRING ],\n          () => (arg1: DirLangStringLiteral, arg2: StringLiteral) => {\n            const [ a1, a2 ] = [ arg1.typedValue, arg2.typedValue ];\n            const sub = arg1.typedValue.slice(0, Math.max(0, a1.indexOf(a2)));\n            return sub || !a2 ? dirLangString(sub, arg1.language, arg1.direction) : string(sub);\n          },\n        )\n        .onBinary(\n          [ TypeURL.RDF_DIR_LANG_STRING, TypeURL.RDF_LANG_STRING ],\n          () => (arg1: DirLangStringLiteral, arg2: LangStringLiteral) => {\n            if (arg1.language !== arg2.language) {\n              throw new IncompatibleLanguageOperation(arg1, arg2);\n            }\n            const [ a1, a2 ] = [ arg1.typedValue, arg2.typedValue ];\n            const sub = arg1.typedValue.slice(0, Math.max(0, a1.indexOf(a2)));\n            return sub || !a2 ? dirLangString(sub, arg1.language, arg1.direction) : string(sub);\n          },\n        )\n        .onBinary(\n          [ TypeURL.RDF_DIR_LANG_STRING, TypeURL.RDF_DIR_LANG_STRING ],\n          () => (arg1: DirLangStringLiteral, arg2: DirLangStringLiteral) => {\n            if (arg1.language !== arg2.language) {\n              throw new IncompatibleLanguageOperation(arg1, arg2);\n            }\n            if (arg1.direction !== arg2.direction) {\n              throw new IncompatibleDirectionalLanguageOperation(arg1, arg2);\n            }\n            const [ a1, a2 ] = [ arg1.typedValue, arg2.typedValue ];\n            const sub = arg1.typedValue.slice(0, Math.max(0, a1.indexOf(a2)));\n            return sub || !a2 ? dirLangString(sub, arg1.language, arg1.direction) : string(sub);\n          },\n        )\n        .collect(),\n    });\n  }\n}\n"]}