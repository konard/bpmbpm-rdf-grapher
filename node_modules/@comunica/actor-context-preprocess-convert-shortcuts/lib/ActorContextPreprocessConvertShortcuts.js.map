{"version":3,"file":"ActorContextPreprocessConvertShortcuts.js","sourceRoot":"","sources":["ActorContextPreprocessConvertShortcuts.ts"],"names":[],"mappings":";;;AACA,6EAA0E;AAE1E,yCAAgE;AAGhE;;GAEG;AACH,MAAa,sCAAuC,SAAQ,+CAAsB;IAChE,mBAAmB,CAAyB;IAE5D,YAAmB,IAAiD;QAClE,KAAK,CAAC,IAAI,CAAC,CAAC;QACZ,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,mBAAmB,CAAC;IACtD,CAAC;IAEM,KAAK,CAAC,IAAI,CAAC,OAAgB;QAChC,OAAO,IAAA,mBAAY,GAAE,CAAC;IACxB,CAAC;IAEM,KAAK,CAAC,GAAG,CAAC,MAAe;QAC9B,OAAO;YACL,OAAO,EAAE,sCAAsC,CAAC,eAAe,CAAC,MAAM,CAAC,OAAO,EAAE,IAAI,CAAC,mBAAmB,CAAC;SAC1G,CAAC;IACJ,CAAC;IAEM,MAAM,CAAC,eAAe,CAAC,OAAuB,EAAE,mBAA2C;QAChG,KAAK,MAAM,GAAG,IAAI,OAAO,CAAC,IAAI,EAAE,EAAE,CAAC;YACjC,IAAI,mBAAmB,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC;gBAClC,OAAO,GAAG,OAAO;qBACd,GAAG,CAAC,IAAI,uBAAgB,CAAC,mBAAmB,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,EAAE,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;qBAC1E,MAAM,CAAC,GAAG,CAAC,CAAC;YACjB,CAAC;QACH,CAAC;QACD,OAAO,OAAO,CAAC;IACjB,CAAC;CACF;AA5BD,wFA4BC","sourcesContent":["import type { IActorContextPreprocessOutput, IActorContextPreprocessArgs } from '@comunica/bus-context-preprocess';\nimport { ActorContextPreprocess } from '@comunica/bus-context-preprocess';\nimport type { IAction, IActorTest, TestResult } from '@comunica/core';\nimport { passTestVoid, ActionContextKey } from '@comunica/core';\nimport type { IActionContext } from '@comunica/types';\n\n/**\n * A comunica Convert Shortcuts Context Preprocess Actor.\n */\nexport class ActorContextPreprocessConvertShortcuts extends ActorContextPreprocess {\n  public readonly contextKeyShortcuts: Record<string, string>;\n\n  public constructor(args: IActorContextPreprocessConvertShortcutsArgs) {\n    super(args);\n    this.contextKeyShortcuts = args.contextKeyShortcuts;\n  }\n\n  public async test(_action: IAction): Promise<TestResult<IActorTest>> {\n    return passTestVoid();\n  }\n\n  public async run(action: IAction): Promise<IActorContextPreprocessOutput> {\n    return {\n      context: ActorContextPreprocessConvertShortcuts.expandShortcuts(action.context, this.contextKeyShortcuts),\n    };\n  }\n\n  public static expandShortcuts(context: IActionContext, contextKeyShortcuts: Record<string, string>): IActionContext {\n    for (const key of context.keys()) {\n      if (contextKeyShortcuts[key.name]) {\n        context = context\n          .set(new ActionContextKey(contextKeyShortcuts[key.name]), context.get(key))\n          .delete(key);\n      }\n    }\n    return context;\n  }\n}\n\nexport interface IActorContextPreprocessConvertShortcutsArgs extends IActorContextPreprocessArgs {\n  /**\n   * A record of context shortcuts to full context keys (as defined in @comunica/context-entries).\n   * These should be aligned with to IQueryContextCommon in @comunica/types,\n   * and possibly the CliArgsHandlers in @comunica/actor-init-query.\n   * @range {json}\n   * @default {{\n   *   \"sources\": \"@comunica/actor-init-query:querySourcesUnidentified\",\n   *   \"destination\": \"@comunica/bus-rdf-update-quads:destination\",\n   *   \"initialBindings\": \"@comunica/actor-init-query:initialBindings\",\n   *   \"queryFormat\": \"@comunica/actor-init-query:queryFormat\",\n   *   \"baseIRI\": \"@comunica/actor-init-query:baseIRI\",\n   *   \"fileBaseIRI\": \"@comunica/actor-init-query:fileBaseIRI\",\n   *   \"log\": \"@comunica/core:log\",\n   *   \"datetime\": \"@comunica/actor-http-memento:datetime\",\n   *   \"queryTimestamp\": \"@comunica/actor-init-query:queryTimestamp\",\n   *   \"queryTimestampHighResolution\": \"@comunica/actor-init-query:queryTimestampHighResolution\",\n   *   \"httpProxyHandler\": \"@comunica/actor-http-proxy:httpProxyHandler\",\n   *   \"lenient\": \"@comunica/actor-init-query:lenient\",\n   *   \"parseUnsupportedVersions\": \"@comunica/actor-init-query:parseUnsupportedVersions\",\n   *   \"httpIncludeCredentials\": \"@comunica/bus-http:include-credentials\",\n   *   \"httpAuth\": \"@comunica/bus-http:auth\",\n   *   \"httpTimeout\": \"@comunica/bus-http:http-timeout\",\n   *   \"httpBodyTimeout\": \"@comunica/bus-http:http-body-timeout\",\n   *   \"httpRetryCount\": \"@comunica/bus-http:http-retry-count\",\n   *   \"httpRetryDelayFallback\": \"@comunica/bus-http:http-retry-delay-fallback\",\n   *   \"httpRetryDelayLimit\": \"@comunica/bus-http:http-retry-delay-limit\",\n   *   \"httpRetryStatusCodes\": \"@comunica/bus-http:http-retry-status-codes\",\n   *   \"httpAbortSignal\": \"@comunica/bus-http:http-abort-controller\",\n   *   \"httpCache\": \"@comunica/bus-http:httpCache\",\n   *   \"fetch\": \"@comunica/bus-http:fetch\",\n   *   \"recoverBrokenLinks\": \"@comunica/bus-http-wayback:recover-broken-links\",\n   *   \"readOnly\": \"@comunica/bus-query-operation:readOnly\",\n   *   \"extensionFunctions\": \"@comunica/actor-init-query:extensionFunctions\",\n   *   \"extensionFunctionsAlwaysPushdown\": \"@comunica/actor-init-query:extensionFunctionsAlwaysPushdown\",\n   *   \"extensionFunctionCreator\": \"@comunica/actor-init-query:extensionFunctionCreator\",\n   *   \"functionArgumentsCache\": \"@comunica/actor-init-query:functionArgumentsCache\",\n   *   \"explain\": \"@comunica/actor-init-query:explain\",\n   *   \"unionDefaultGraph\": \"@comunica/bus-query-operation:unionDefaultGraph\",\n   *   \"traverse\": \"@comunica/bus-query-source-identify:traverse\",\n   *   \"invalidateCache\": \"@comunica/actor-init-query:invalidateCache\",\n   *   \"dataFactory\": \"@comunica/actor-init-query:dataFactory\",\n   *   \"distinctConstruct\": \"@comunica/actor-init-query:distinctConstruct\",\n   *   \"rdfSerializationPrefixes\": \"@comunica/bus-rdf-serialize:rdfSerializationPrefixes\"\n   * }}\n   */\n  contextKeyShortcuts: Record<string, string>;\n}\n"]}