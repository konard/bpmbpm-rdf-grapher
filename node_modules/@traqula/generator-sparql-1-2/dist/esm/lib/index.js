import { GeneratorBuilder } from '@traqula/core';
import { sparql11GeneratorBuilder } from '@traqula/generator-sparql-1-1';
import { gram as g12, completeGeneratorContext } from '@traqula/rules-sparql-1-2';
export const sparql12GeneratorBuilder = GeneratorBuilder.create(sparql11GeneratorBuilder)
    .widenContext()
    .typePatch()
    .addRule(g12.tripleTerm)
    .addRule(g12.reifiedTriple)
    .patchRule(g12.graphNodePath)
    .addRule(g12.annotationBlockPath)
    .addRule(g12.annotationPath)
    .addRule(g12.versionDecl)
    .patchRule(g12.prologue)
    .patchRule(g12.generateTriplesBlock)
    .patchRule(g12.generateGraphTerm);
/**
 * Generator that can generate a SPARQL 1.2 query string given a SPARQL 1.2 Traqula AST.
 */
export class Generator {
    defaultContext;
    constructor(defaultContext = {}) {
        this.defaultContext = completeGeneratorContext(defaultContext);
    }
    generator = sparql12GeneratorBuilder.build();
    /**
     * Generates a query string starting from the
     * [QueryUnit](https://www.w3.org/TR/sparql12-query/#rQueryUnit)
     * or [QueryUpdate](https://www.w3.org/TR/sparql12-query/#rUpdateUnit) rules.
     * @param ast
     * @param context
     */
    generate(ast, context = {}) {
        return this.generator.queryOrUpdate(ast, { ...this.defaultContext, ...context }).trim();
    }
    /**
     * Generates a query string starting from the [Path](https://www.w3.org/TR/sparql12-query/#rPath) grammar rule.
     * @param ast
     * @param context
     */
    generatePath(ast, context = {}) {
        return this.generator.path(ast, { ...this.defaultContext, ...context }, undefined).trim();
    }
}
//# sourceMappingURL=index.js.map