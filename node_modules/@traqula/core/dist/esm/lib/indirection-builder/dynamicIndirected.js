export class DynamicIndirect {
    rules;
    __context = undefined;
    constructor(rules) {
        this.rules = rules;
        for (const rule of Object.values(rules)) {
            this[rule.name] = ((context, ...args) => {
                this.setContext(context);
                return this.subrule(rule, ...args);
            });
        }
    }
    setContext(context) {
        this.__context = context;
    }
    getSafeContext() {
        return this.__context;
    }
    subrule = (cstDef, ...args) => {
        const def = this.rules[cstDef.name];
        if (!def) {
            throw new Error(`Rule ${cstDef.name} not found`);
        }
        return def.fun({
            SUBRULE: this.subrule,
        })(this.getSafeContext(), ...args);
    };
}
//# sourceMappingURL=dynamicIndirected.js.map