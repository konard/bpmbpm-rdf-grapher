{"version":3,"file":"index.js","sourceRoot":"","sources":["../../../lib/index.ts"],"names":[],"mappings":"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","sourcesContent":["import { GeneratorBuilder } from '@traqula/core';\nimport type * as T11 from '@traqula/rules-sparql-1-1';\nimport { gram, completeGeneratorContext } from '@traqula/rules-sparql-1-1';\n\nexport const sparql11GeneratorBuilder = GeneratorBuilder.create(<const> [\n  gram.queryOrUpdate,\n  gram.query,\n  gram.selectQuery,\n  gram.constructQuery,\n  gram.describeQuery,\n  gram.askQuery,\n  gram.selectClause,\n])\n  .addMany(\n    gram.update,\n    gram.update1,\n    gram.load,\n    gram.clear,\n    gram.drop,\n    gram.create,\n    gram.copy,\n    gram.move,\n    gram.add,\n    gram.insertData,\n    gram.deleteData,\n    gram.deleteWhere,\n    gram.modify,\n    gram.graphRef,\n    gram.graphRefAll,\n    gram.quads,\n    gram.quadsNotTriples,\n  )\n  .addRule(gram.aggregate)\n  .addMany(\n    gram.datasetClauseStar,\n    gram.usingClauseStar,\n  )\n  .addMany(\n    gram.argList,\n    gram.expression,\n    gram.iriOrFunction,\n  )\n  .addMany(\n    gram.prologue,\n    gram.prefixDecl,\n    gram.baseDecl,\n    gram.varOrTerm,\n    gram.var_,\n    gram.graphTerm,\n  )\n  .addMany(\n    gram.rdfLiteral,\n    gram.iri,\n    gram.iriFull,\n    gram.prefixedName,\n    gram.blankNode,\n  )\n  .addRule(gram.pathGenerator)\n  .addMany(\n    gram.solutionModifier,\n    gram.groupClause,\n    gram.havingClause,\n    gram.orderClause,\n    gram.limitOffsetClauses,\n  )\n  .addMany(\n    gram.triplesBlock,\n    gram.collectionPath,\n    gram.blankNodePropertyListPath,\n    gram.triplesNodePath,\n    gram.graphNodePath,\n  )\n  .addMany(\n    gram.whereClause,\n    gram.generatePattern,\n    gram.groupGraphPattern,\n    gram.graphPatternNotTriples,\n    gram.optionalGraphPattern,\n    gram.graphGraphPattern,\n    gram.serviceGraphPattern,\n    gram.bind,\n    gram.inlineData,\n    gram.minusGraphPattern,\n    gram.groupOrUnionGraphPattern,\n    gram.filter,\n  );\n\nexport type SparqlGenerator = ReturnType<typeof sparql11GeneratorBuilder.build>;\n\n/**\n * Generator that can generate a SPARQL 1.1 query string given a SPARQL 1.1 Traqula AST.\n */\nexport class Generator {\n  protected readonly defaultContext: T11.SparqlGeneratorContext;\n  public constructor(defaultContext: Partial<T11.SparqlGeneratorContext> = {}) {\n    this.defaultContext = completeGeneratorContext(defaultContext);\n  }\n\n  private readonly generator: SparqlGenerator = sparql11GeneratorBuilder.build();\n\n  /**\n   * Generates a query string starting from the\n   * [QueryUnit](https://www.w3.org/TR/sparql11-query/#rQueryUnit)\n   * or [QueryUpdate](https://www.w3.org/TR/sparql11-query/#rUpdateUnit) rules.\n   * @param ast\n   * @param context\n   */\n  public generate(ast: T11.Query | T11.Update, context: Partial<T11.SparqlGeneratorContext> = {}): string {\n    return this.generator.queryOrUpdate(ast, { ...this.defaultContext, ...context }).trim();\n  }\n\n  /**\n   * Generates a query string starting from the [Path](https://www.w3.org/TR/sparql11-query/#rPath) grammar rule.\n   * @param ast\n   * @param context\n   */\n  public generatePath(ast: T11.Path, context: Partial<T11.SparqlGeneratorContext> = {}): string {\n    return this.generator.path(ast, completeGeneratorContext({ ...this.defaultContext, ...context }), undefined).trim();\n  }\n}\n"]}