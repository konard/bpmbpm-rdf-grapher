"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.Generator = exports.sparql11GeneratorBuilder = void 0;
const core_1 = require("@traqula/core");
const rules_sparql_1_1_1 = require("@traqula/rules-sparql-1-1");
exports.sparql11GeneratorBuilder = core_1.GeneratorBuilder.create([
    rules_sparql_1_1_1.gram.queryOrUpdate,
    rules_sparql_1_1_1.gram.query,
    rules_sparql_1_1_1.gram.selectQuery,
    rules_sparql_1_1_1.gram.constructQuery,
    rules_sparql_1_1_1.gram.describeQuery,
    rules_sparql_1_1_1.gram.askQuery,
    rules_sparql_1_1_1.gram.selectClause,
])
    .addMany(rules_sparql_1_1_1.gram.update, rules_sparql_1_1_1.gram.update1, rules_sparql_1_1_1.gram.load, rules_sparql_1_1_1.gram.clear, rules_sparql_1_1_1.gram.drop, rules_sparql_1_1_1.gram.create, rules_sparql_1_1_1.gram.copy, rules_sparql_1_1_1.gram.move, rules_sparql_1_1_1.gram.add, rules_sparql_1_1_1.gram.insertData, rules_sparql_1_1_1.gram.deleteData, rules_sparql_1_1_1.gram.deleteWhere, rules_sparql_1_1_1.gram.modify, rules_sparql_1_1_1.gram.graphRef, rules_sparql_1_1_1.gram.graphRefAll, rules_sparql_1_1_1.gram.quads, rules_sparql_1_1_1.gram.quadsNotTriples)
    .addRule(rules_sparql_1_1_1.gram.aggregate)
    .addMany(rules_sparql_1_1_1.gram.datasetClauseStar, rules_sparql_1_1_1.gram.usingClauseStar)
    .addMany(rules_sparql_1_1_1.gram.argList, rules_sparql_1_1_1.gram.expression, rules_sparql_1_1_1.gram.iriOrFunction)
    .addMany(rules_sparql_1_1_1.gram.prologue, rules_sparql_1_1_1.gram.prefixDecl, rules_sparql_1_1_1.gram.baseDecl, rules_sparql_1_1_1.gram.varOrTerm, rules_sparql_1_1_1.gram.var_, rules_sparql_1_1_1.gram.graphTerm)
    .addMany(rules_sparql_1_1_1.gram.rdfLiteral, rules_sparql_1_1_1.gram.iri, rules_sparql_1_1_1.gram.iriFull, rules_sparql_1_1_1.gram.prefixedName, rules_sparql_1_1_1.gram.blankNode)
    .addRule(rules_sparql_1_1_1.gram.pathGenerator)
    .addMany(rules_sparql_1_1_1.gram.solutionModifier, rules_sparql_1_1_1.gram.groupClause, rules_sparql_1_1_1.gram.havingClause, rules_sparql_1_1_1.gram.orderClause, rules_sparql_1_1_1.gram.limitOffsetClauses)
    .addMany(rules_sparql_1_1_1.gram.triplesBlock, rules_sparql_1_1_1.gram.collectionPath, rules_sparql_1_1_1.gram.blankNodePropertyListPath, rules_sparql_1_1_1.gram.triplesNodePath, rules_sparql_1_1_1.gram.graphNodePath)
    .addMany(rules_sparql_1_1_1.gram.whereClause, rules_sparql_1_1_1.gram.generatePattern, rules_sparql_1_1_1.gram.groupGraphPattern, rules_sparql_1_1_1.gram.graphPatternNotTriples, rules_sparql_1_1_1.gram.optionalGraphPattern, rules_sparql_1_1_1.gram.graphGraphPattern, rules_sparql_1_1_1.gram.serviceGraphPattern, rules_sparql_1_1_1.gram.bind, rules_sparql_1_1_1.gram.inlineData, rules_sparql_1_1_1.gram.minusGraphPattern, rules_sparql_1_1_1.gram.groupOrUnionGraphPattern, rules_sparql_1_1_1.gram.filter);
/**
 * Generator that can generate a SPARQL 1.1 query string given a SPARQL 1.1 Traqula AST.
 */
class Generator {
    defaultContext;
    constructor(defaultContext = {}) {
        this.defaultContext = (0, rules_sparql_1_1_1.completeGeneratorContext)(defaultContext);
    }
    generator = exports.sparql11GeneratorBuilder.build();
    /**
     * Generates a query string starting from the
     * [QueryUnit](https://www.w3.org/TR/sparql11-query/#rQueryUnit)
     * or [QueryUpdate](https://www.w3.org/TR/sparql11-query/#rUpdateUnit) rules.
     * @param ast
     * @param context
     */
    generate(ast, context = {}) {
        return this.generator.queryOrUpdate(ast, { ...this.defaultContext, ...context }).trim();
    }
    /**
     * Generates a query string starting from the [Path](https://www.w3.org/TR/sparql11-query/#rPath) grammar rule.
     * @param ast
     * @param context
     */
    generatePath(ast, context = {}) {
        return this.generator.path(ast, (0, rules_sparql_1_1_1.completeGeneratorContext)({ ...this.defaultContext, ...context }), undefined).trim();
    }
}
exports.Generator = Generator;
//# sourceMappingURL=index.js.map