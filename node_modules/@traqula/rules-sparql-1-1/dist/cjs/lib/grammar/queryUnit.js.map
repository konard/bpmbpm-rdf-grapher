{"version":3,"file":"queryUnit.js","sourceRoot":"","sources":["../../../../lib/grammar/queryUnit.ts"],"names":[],"mappings":"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","sourcesContent":["import type { IToken } from '@traqula/chevrotain';\nimport type { Localized, RuleDefReturn, Wrap } from '@traqula/core';\nimport { traqulaIndentation } from '@traqula/core';\nimport * as l from '../lexer/index.js';\nimport type { SparqlGrammarRule, SparqlRule } from '../sparql11HelperTypes.js';\nimport type {\n  PatternBgp,\n  PatternBind,\n  PatternValues,\n  Query,\n  QueryAsk,\n  QueryConstruct,\n  QueryDescribe,\n  QuerySelect,\n  SubSelect,\n  TermIri,\n  TermVariable,\n  Wildcard,\n} from '../Sparql11types.js';\nimport { queryProjectionIsGood } from '../validation/validators.js';\nimport { datasetClauseStar } from './dataSetClause.js';\nimport { expression } from './expression.js';\nimport { prologue, var_, varOrIri, varOrTerm } from './general.js';\nimport { solutionModifier } from './solutionModifier.js';\nimport { triplesBlock, triplesTemplate } from './tripleBlock.js';\nimport { inlineData, whereClause } from './whereClause.js';\n\n/**\n * [[1]](https://www.w3.org/TR/sparql11-query/#rQueryUnit)\n */\nexport const queryUnit: SparqlGrammarRule<'queryUnit', Query> = <const> {\n  name: 'queryUnit',\n  impl: ({ SUBRULE }) => () => SUBRULE(query),\n};\n\nexport type HandledByBase = 'type' | 'context' | 'values';\n\n/**\n * [[2]](https://www.w3.org/TR/sparql11-query/#rQuery)\n */\nexport const query: SparqlRule<'query', Query> = <const> {\n  name: 'query',\n  impl: ({ ACTION, SUBRULE, OR }) => (C) => {\n    const prologueValues = SUBRULE(prologue);\n    const subType = OR<Omit<Query, HandledByBase>>([\n      { ALT: () => SUBRULE(selectQuery) },\n      { ALT: () => SUBRULE(constructQuery) },\n      { ALT: () => SUBRULE(describeQuery) },\n      { ALT: () => SUBRULE(askQuery) },\n    ]);\n    const values = SUBRULE(valuesClause);\n\n    return ACTION(() => (<Query>{\n      context: prologueValues,\n      ...subType,\n      type: 'query',\n      ...(values && { values }),\n      loc: C.astFactory.sourceLocation(\n        prologueValues.at(0),\n        subType,\n        values,\n      ),\n    }));\n  },\n  gImpl: ({ SUBRULE }) => (ast, { astFactory: F }) => {\n    SUBRULE(prologue, ast.context);\n    if (F.isQuerySelect(ast)) {\n      SUBRULE(selectQuery, ast);\n    } else if (F.isQueryConstruct(ast)) {\n      SUBRULE(constructQuery, ast);\n    } else if (F.isQueryDescribe(ast)) {\n      SUBRULE(describeQuery, ast);\n    } else if (F.isQueryAsk(ast)) {\n      SUBRULE(askQuery, ast);\n    }\n    if (ast.values) {\n      SUBRULE(inlineData, ast.values);\n    }\n  },\n};\n\n/**\n * [[7]](https://www.w3.org/TR/sparql11-query/#rSelectQuery)\n */\nexport const selectQuery: SparqlRule<'selectQuery', Omit<QuerySelect, HandledByBase>> = <const> {\n  name: 'selectQuery',\n  impl: ({ ACTION, SUBRULE }) => (C) => {\n    const selectVal = SUBRULE(selectClause);\n    const from = SUBRULE(datasetClauseStar);\n    const where = SUBRULE(whereClause);\n    const modifiers = SUBRULE(solutionModifier);\n\n    return ACTION(() => {\n      const ret = {\n        subType: 'select',\n        where: where.val,\n        solutionModifiers: modifiers,\n        datasets: from,\n        ...selectVal.val,\n        loc: C.astFactory.sourceLocation(\n          selectVal,\n          where,\n          modifiers.group,\n          modifiers.having,\n          modifiers.order,\n          modifiers.limitOffset,\n        ),\n      } satisfies RuleDefReturn<typeof selectQuery>;\n      if (!C.skipValidation) {\n        queryProjectionIsGood(ret);\n      }\n      return ret;\n    });\n  },\n  gImpl: ({ SUBRULE }) => (ast, { astFactory: F }) => {\n    SUBRULE(selectClause, F.wrap({\n      variables: ast.variables,\n      distinct: ast.distinct,\n      reduced: ast.reduced,\n    }, F.sourceLocation(...ast.variables)));\n    SUBRULE(datasetClauseStar, ast.datasets);\n    SUBRULE(whereClause, F.wrap(ast.where, ast.where.loc));\n    SUBRULE(solutionModifier, ast.solutionModifiers);\n  },\n};\n\n/**\n * [[8]](https://www.w3.org/TR/sparql11-query/#rSubSelect)\n */\nexport const subSelect: SparqlGrammarRule<'subSelect', SubSelect> = <const> {\n  name: 'subSelect',\n  impl: ({ ACTION, SUBRULE }) => (C) => {\n    const selectVal = SUBRULE(selectClause);\n    const where = SUBRULE(whereClause);\n    const modifiers = SUBRULE(solutionModifier);\n    const values = SUBRULE(valuesClause);\n\n    return ACTION(() => C.astFactory.querySelect({\n      where: where.val,\n      datasets: C.astFactory.datasetClauses([], C.astFactory.sourceLocation()),\n      context: [],\n      solutionModifiers: modifiers,\n      ...selectVal.val,\n      ...(values && { values }),\n    }, C.astFactory.sourceLocation(\n      selectVal,\n      where,\n      modifiers.group,\n      modifiers.having,\n      modifiers.order,\n      modifiers.limitOffset,\n      values,\n    )));\n  },\n};\n\n/**\n * [[9]](https://www.w3.org/TR/sparql11-query/#rSelectClause)\n */\nexport const selectClause: SparqlRule<'selectClause', Wrap<Pick<QuerySelect, 'variables' | 'distinct' | 'reduced'>>> = {\n  name: 'selectClause',\n  impl: ({\n    ACTION,\n    AT_LEAST_ONE,\n    SUBRULE1,\n    SUBRULE2,\n    CONSUME,\n    OPTION,\n    OR1,\n    OR2,\n    OR3,\n  }) => (C) => {\n    const select = CONSUME(l.select);\n    const couldParseAgg = ACTION(() => C.parseMode.has('canParseAggregate') || !C.parseMode.add('canParseAggregate'));\n\n    const distinctAndReduced = OPTION(() => OR1<[boolean, boolean]>([\n      { ALT: () => {\n        CONSUME(l.distinct);\n        return <const> [ true, false ];\n      } },\n      { ALT: () => {\n        CONSUME(l.reduced);\n        return <const> [ false, true ];\n      } },\n    ])) ?? [ false, false ];\n    const distRed = ACTION(() => {\n      const [ distinct, reduced ] = distinctAndReduced;\n      return {\n        ...(distinct && { distinct }),\n        ...(reduced && { reduced }),\n      };\n    });\n\n    let last: Localized | IToken;\n    const val = OR2<RuleDefReturn<typeof selectClause>['val']>([\n      { ALT: () => {\n        const star = CONSUME(l.symbols.star);\n        return ACTION(() => {\n          last = star;\n          return { variables: [ C.astFactory.wildcard(C.astFactory.sourceLocation(star)) ], ...distRed };\n        });\n      } },\n      { ALT: () => {\n        const usedVars: TermVariable[] = [];\n        const variables: (TermVariable | PatternBind)[] = [];\n        AT_LEAST_ONE(() => OR3([\n          { ALT: () => {\n            const raw = SUBRULE1(var_);\n            ACTION(() => {\n              if (!C.skipValidation && usedVars.some(v => v.value === raw.value)) {\n                throw new Error(`Variable ${raw.value} used more than once in SELECT clause`);\n              }\n              usedVars.push(raw);\n              variables.push(raw);\n              last = raw;\n            });\n          } },\n          { ALT: () => {\n            const open = CONSUME(l.symbols.LParen);\n            const expr = SUBRULE1(expression);\n            CONSUME(l.as);\n            const variable = SUBRULE2(var_);\n            const close = CONSUME(l.symbols.RParen);\n            ACTION(() => {\n              last = close;\n              if (!C.skipValidation && usedVars.some(v => v.value === variable.value)) {\n                throw new Error(`Variable ${variable.value} used more than once in SELECT clause`);\n              }\n              usedVars.push(variable);\n              variables.push(C.astFactory.patternBind(expr, variable, C.astFactory.sourceLocation(open, last)));\n            });\n          } },\n        ]));\n        return { variables, ...distRed };\n      } },\n    ]);\n    ACTION(() => !couldParseAgg && C.parseMode.delete('canParseAggregate'));\n    return ACTION(() => C.astFactory.wrap(val, C.astFactory.sourceLocation(select, last)));\n  },\n  gImpl: ({ SUBRULE, PRINT_WORD, PRINT_ON_EMPTY }) => (ast, { astFactory: F }) => {\n    F.printFilter(ast, () => {\n      PRINT_ON_EMPTY('SELECT ');\n      if (ast.val.distinct) {\n        PRINT_WORD('DISTINCT');\n      } else if (ast.val.reduced) {\n        PRINT_WORD('REDUCED');\n      }\n    });\n    for (const variable of ast.val.variables) {\n      if (F.isWildcard(variable)) {\n        F.printFilter(ast, () => PRINT_WORD('*'));\n      } else if (F.isTerm(variable)) {\n        SUBRULE(var_, variable);\n      } else {\n        F.printFilter(ast, () => PRINT_WORD('('));\n        SUBRULE(expression, variable.expression);\n        F.printFilter(ast, () => PRINT_WORD('AS'));\n        SUBRULE(var_, variable.variable);\n        F.printFilter(ast, () => PRINT_WORD(')'));\n      }\n      F.printFilter(ast, () => PRINT_WORD(''));\n    }\n    F.printFilter(ast, () => PRINT_WORD(''));\n  },\n\n};\n\n/**\n * [[10]](https://www.w3.org/TR/sparql11-query/#rConstructQuery)\n */\nexport const constructQuery: SparqlRule<'constructQuery', Omit<QueryConstruct, HandledByBase>> = <const> {\n  name: 'constructQuery',\n  impl: ({ ACTION, SUBRULE1, SUBRULE2, CONSUME, OR }) => (C) => {\n    const construct = CONSUME(l.construct);\n    return OR<Omit<QueryConstruct, HandledByBase>>([\n      { ALT: () => {\n        const template = SUBRULE1(constructTemplate);\n        const from = SUBRULE1(datasetClauseStar);\n        const where = SUBRULE1(whereClause);\n        const modifiers = SUBRULE1(solutionModifier);\n        return ACTION(() => ({\n          subType: 'construct',\n          template: template.val,\n          datasets: from,\n          where: where.val,\n          solutionModifiers: modifiers,\n          loc: C.astFactory.sourceLocation(\n            construct,\n            where,\n            modifiers.group,\n            modifiers.having,\n            modifiers.order,\n            modifiers.limitOffset,\n          ),\n        } satisfies Omit<QueryConstruct, HandledByBase>));\n      } },\n      { ALT: () => {\n        const from = SUBRULE2(datasetClauseStar);\n        CONSUME(l.where);\n        // ConstructTemplate is same as '{' TriplesTemplate? '}'\n        const template = SUBRULE2(constructTemplate);\n        const modifiers = SUBRULE2(solutionModifier);\n\n        return ACTION(() => ({\n          subType: 'construct',\n          template: template.val,\n          datasets: from,\n          where: C.astFactory.patternGroup([ template.val ], C.astFactory.sourceLocation()),\n          solutionModifiers: modifiers,\n          loc: C.astFactory.sourceLocation(\n            construct,\n            template,\n            modifiers.group,\n            modifiers.having,\n            modifiers.order,\n            modifiers.limitOffset,\n          ),\n        }));\n      } },\n    ]);\n  },\n  gImpl: ({ SUBRULE, PRINT_WORD, PRINT_ON_EMPTY, PRINT_ON_OWN_LINE, NEW_LINE }) => (ast, C) => {\n    const { astFactory: F, indentInc } = C;\n    F.printFilter(ast, () => PRINT_ON_EMPTY('CONSTRUCT '));\n    if (!F.isSourceLocationNoMaterialize(ast.where.loc)) {\n      // You are NOT in second case construct\n      F.printFilter(ast, () => {\n        C[traqulaIndentation] += indentInc;\n        PRINT_WORD('{');\n        NEW_LINE();\n      });\n      SUBRULE(triplesBlock, ast.template);\n      F.printFilter(ast, () => {\n        C[traqulaIndentation] -= indentInc;\n        PRINT_ON_OWN_LINE('}');\n      });\n    }\n    SUBRULE(datasetClauseStar, ast.datasets);\n    if (F.isSourceLocationNoMaterialize(ast.where.loc)) {\n      SUBRULE(whereClause, F.wrap(F.patternGroup([ ast.template ], ast.template.loc), ast.template.loc));\n    } else {\n      SUBRULE(whereClause, F.wrap(ast.where, ast.where.loc));\n    }\n    SUBRULE(solutionModifier, ast.solutionModifiers);\n  },\n};\n\n/**\n * [[11]](https://www.w3.org/TR/sparql11-query/#rDescribeQuery)\n */\nexport const describeQuery: SparqlRule<'describeQuery', Omit<QueryDescribe, HandledByBase>> = <const> {\n  name: 'describeQuery',\n  impl: ({ ACTION, AT_LEAST_ONE, SUBRULE1, CONSUME, OPTION, OR }) => (C) => {\n    const describe = CONSUME(l.describe);\n    const variables = OR<QueryDescribe['variables']>([\n      { ALT: () => {\n        const variables: (TermVariable | TermIri)[] = [];\n        AT_LEAST_ONE(() => {\n          variables.push(SUBRULE1(varOrIri));\n        });\n        return variables;\n      } },\n      { ALT: () => {\n        const star = CONSUME(l.symbols.star);\n        return [ ACTION(() => C.astFactory.wildcard(C.astFactory.sourceLocation(star))) ];\n      } },\n    ]);\n    const from = SUBRULE1(datasetClauseStar);\n    const where = OPTION(() => SUBRULE1(whereClause));\n    const modifiers = SUBRULE1(solutionModifier);\n    return ACTION(() => ({\n      subType: 'describe',\n      variables,\n      datasets: from,\n      ...(where && { where: where.val }),\n      solutionModifiers: modifiers,\n      loc: C.astFactory.sourceLocation(\n        describe,\n        ...variables,\n        from,\n        where,\n        modifiers.group,\n        modifiers.having,\n        modifiers.order,\n        modifiers.limitOffset,\n      ),\n    }));\n  },\n  gImpl: ({ SUBRULE, PRINT_WORD, PRINT_ON_EMPTY }) => (ast, { astFactory: F }) => {\n    F.printFilter(ast, () => PRINT_ON_EMPTY('DESCRIBE '));\n    if (F.isWildcard(ast.variables[0])) {\n      F.printFilter(ast, () => PRINT_WORD('*'));\n    } else {\n      for (const variable of (<Exclude<QueryDescribe['variables'], [Wildcard]>> ast.variables)) {\n        SUBRULE(varOrTerm, variable);\n      }\n    }\n    SUBRULE(datasetClauseStar, ast.datasets);\n    if (ast.where) {\n      SUBRULE(whereClause, F.wrap(ast.where, ast.loc));\n    }\n    SUBRULE(solutionModifier, ast.solutionModifiers);\n  },\n};\n\n/**\n * [[12]](https://www.w3.org/TR/sparql11-query/#rAskQuery)\n */\nexport const askQuery: SparqlRule<'askQuery', Omit<QueryAsk, HandledByBase>> = <const> {\n  name: 'askQuery',\n  impl: ({ ACTION, SUBRULE, CONSUME }) => (C) => {\n    const ask = CONSUME(l.ask);\n    const from = SUBRULE(datasetClauseStar);\n    const where = SUBRULE(whereClause);\n    const modifiers = SUBRULE(solutionModifier);\n\n    return ACTION(() => ({\n      subType: 'ask',\n      datasets: from,\n      where: where.val,\n      solutionModifiers: modifiers,\n      loc: C.astFactory.sourceLocation(\n        ask,\n        from,\n        where,\n        modifiers.group,\n        modifiers.having,\n        modifiers.order,\n        modifiers.limitOffset,\n      ),\n    } satisfies RuleDefReturn<typeof askQuery>));\n  },\n  gImpl: ({ SUBRULE, PRINT_ON_EMPTY }) => (ast, { astFactory: F }) => {\n    F.printFilter(ast, () => PRINT_ON_EMPTY('ASK '));\n    SUBRULE(datasetClauseStar, ast.datasets);\n    SUBRULE(whereClause, F.wrap(ast.where, ast.loc));\n    SUBRULE(solutionModifier, ast.solutionModifiers);\n  },\n};\n\n/**\n * [[28]](https://www.w3.org/TR/sparql11-query/#rValuesClause)\n */\nexport const valuesClause: SparqlGrammarRule<'valuesClause', PatternValues | undefined> = <const> {\n  name: 'valuesClause',\n  impl: ({ OPTION, SUBRULE }) => () => OPTION(() => SUBRULE(inlineData)),\n};\n\n/**\n * [[73]](https://www.w3.org/TR/sparql11-query/#ConstructTemplate)\n */\nexport const constructTemplate: SparqlGrammarRule<'constructTemplate', Wrap<PatternBgp>> = <const> {\n  name: 'constructTemplate',\n  impl: ({ ACTION, SUBRULE1, CONSUME, OPTION }) => (C) => {\n    const open = CONSUME(l.symbols.LCurly);\n    const triples = OPTION(() => SUBRULE1(constructTriples));\n    const close = CONSUME(l.symbols.RCurly);\n\n    return ACTION(() => C.astFactory.wrap(\n      triples ?? C.astFactory.patternBgp([], C.astFactory.sourceLocation()),\n      C.astFactory.sourceLocation(open, close),\n    ));\n  },\n};\n\n/**\n * [[12]](https://www.w3.org/TR/sparql11-query/#rConstructTriples)\n */\nexport const constructTriples: SparqlGrammarRule<'constructTriples', PatternBgp> = <const> {\n  name: 'constructTriples',\n  impl: triplesTemplate.impl,\n};\n"]}