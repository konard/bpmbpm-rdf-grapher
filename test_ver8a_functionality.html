<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test ver8a Functionality</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; }
        .result { margin: 10px 0; padding: 10px; background: #f5f5f5; }
        .pass { color: green; }
        .fail { color: red; }
        button { margin: 5px; padding: 10px; }
        iframe { width: 100%; height: 500px; border: 1px solid #ccc; }
    </style>
</head>
<body>
    <h1>Test ver8a Functionality</h1>
    
    <div class="test-section">
        <h2>Function Existence Tests</h2>
        <button onclick="testFunctionExistence()">Test Functions</button>
        <div id="function-results" class="result"></div>
    </div>

    <div class="test-section">
        <h2>Element Access Tests</h2>
        <button onclick="testElementAccess()">Test Elements</button>
        <div id="element-results" class="result"></div>
    </div>

    <div class="test-section">
        <h2>Manual Testing</h2>
        <iframe src="index.html" id="test-frame"></iframe>
        <div class="result">
            <h3>Manual Test Checklist:</h3>
            <ul>
                <li>☐ Click "Показать" button - should show graph</li>
                <li>☐ Click "Очистить" button - should clear input</li>
                <li>☐ Click "Тест" button - should validate input</li>
                <li>☐ Click "Сохранить как" button - should save file</li>
                <li>☐ Check "Макс. длина VAD:" field visibility</li>
                <li>☐ Check Smart Design panel visibility</li>
                <li>☐ Check Result in SPARQL panel visibility</li>
                <li>☐ Test example data loading</li>
            </ul>
        </div>
    </div>

    <script>
        function testFunctionExistence() {
            const results = document.getElementById('function-results');
            const frame = document.getElementById('test-frame');
            const frameWindow = frame.contentWindow;
            
            const tests = [
                'visualize',
                'clearRdfInput', 
                'saveAsFile',
                'testRdfValidation',
                'loadExampleTrigVADv4',
                'updateModeDescription',
                'toggleSparqlPanel'
            ];
            
            let html = '<h3>Function Tests:</h3>';
            
            tests.forEach(func => {
                try {
                    if (typeof frameWindow[func] === 'function') {
                        html += `<div class="pass">✓ ${func} exists</div>`;
                    } else {
                        html += `<div class="fail">✗ ${func} missing</div>`;
                    }
                } catch (e) {
                    html += `<div class="fail">✗ ${func} error: ${e.message}</div>`;
                }
            });
            
            results.innerHTML = html;
        }

        function testElementAccess() {
            const results = document.getElementById('element-results');
            const frame = document.getElementById('test-frame');
            const frameDoc = frame.contentDocument;
            
            const elements = [
                'rdf-input',
                'visualize-btn',
                'visualization-mode',
                'sparql-mode',
                'max-vad-row-length-group',
                'smart-design-container',
                'result-sparql-query'
            ];
            
            let html = '<h3>Element Tests:</h3>';
            
            elements.forEach(id => {
                try {
                    const element = frameDoc.getElementById(id);
                    if (element) {
                        const display = window.getComputedStyle(element).display;
                        const visible = display !== 'none';
                        html += `<div class="pass">✓ ${id} exists (${visible ? 'visible' : 'hidden'})</div>`;
                    } else {
                        html += `<div class="fail">✗ ${id} not found</div>`;
                    }
                } catch (e) {
                    html += `<div class="fail">✗ ${id} error: ${e.message}</div>`;
                }
            });
            
            results.innerHTML = html;
        }
    </script>
</body>
</html>